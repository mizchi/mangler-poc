var t={},e=e=>{if("*"===e)return"*";const s=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);return s?(t[e]||(s[2]?t[e]=[e,s[1],new RegExp("^"+s[2]+"$")]:t[e]=[e,s[1],!0]),t[e]):null},s=t=>{const e=t.url,s=e.indexOf("?",8);return e.slice(e.indexOf("/",8),-1===s?void 0:s)},r=t=>{const e=s(t);return e.length>1&&"/"===e[e.length-1]?e.slice(0,-1):e},i=(...t)=>{let e="",s=!1;for(let r of t)"/"===e[e.length-1]&&(e=e.slice(0,-1),s=!0),"/"!==r[0]&&(r=`/${r}`),"/"===r&&s?e=`${e}/`:"/"!==r&&(e=`${e}${r}`),"/"===r&&""===e&&(e="/");return e},n=t=>{const e=t.match(/^(.+|)(\/\:[^\/]+)\?$/);if(!e)return null;const s=e[1],r=s+e[2];return[""===s?"/":s.replace(/\/$/,""),r]},o=t=>/[%+]/.test(t)?(t.includes("+")&&(t=t.replace(/\+/g," ")),t.includes("%")?c(t):t):t,h=(t,e,s)=>{let r;if(!s&&e&&!/[%+]/.test(e)){let s=t.indexOf(`?${e}`,8);for(-1===s&&(s=t.indexOf(`&${e}`,8));-1!==s;){const r=t.charCodeAt(s+e.length+1);if(61===r){const r=s+e.length+2,i=t.indexOf("&",r);return o(t.slice(r,-1===i?void 0:i))}if(38==r||isNaN(r))return"";s=t.indexOf(`&${e}`,s+1)}if(r=/[%+]/.test(t),!r)return}const i={};r??(r=/[%+]/.test(t));let n=t.indexOf("?",8);for(;-1!==n;){const e=t.indexOf("&",n+1);let h=t.indexOf("=",n);h>e&&-1!==e&&(h=-1);let a,c=t.slice(n+1,-1===h?-1===e?void 0:e:h);(r&&(c=o(c)),n=e,""!==c)&&(-1===h?a="":(a=t.slice(h+1,-1===e?void 0:e),r&&(a=o(a))),s?(i[c]??(i[c]=[])).push(a):i[c]??(i[c]=a))}return e?i[e]:i},a=h,c=decodeURIComponent,u=class{constructor(t,e){this.t={},this.i=!1,this.error=void 0,this.o=200,this.h=!1,this.u=2,this.l=void 0,this.p=void 0,this.m="/",this.g=()=>new Response,this.v=(t,e,s)=>{if(void 0===e)return this.l?this.l.delete(t):this.p&&delete this.p[t.toLocaleLowerCase()],void(this.i&&this.$.headers.delete(t));s?.append?(this.l||(this.l=new Headers(this.p),this.p={}),this.l.append(t,e)):this.l?this.l.set(t,e):(this.p??(this.p={}),this.p[t.toLowerCase()]=e),this.i&&(s?.append?this.$.headers.append(t,e):this.$.headers.set(t,e))},this.status=t=>{this.o=t},this.set=(t,e)=>{this.R||(this.R={}),this.R[t]=e},this.get=t=>this.R?this.R[t]:void 0,this.j=(t,e=2)=>{this.h=t,this.u=e},this.O=(t,e,s)=>{if(!(s||this.l||this.A||e||200!==this.o))return new Response(t,{headers:this.p});if(e&&"number"!=typeof e){const s=new Response(t,e),r=this.p?.["S"];return r&&s.headers.set("content-type",r),s}const r=e??this.o;this.p??(this.p={}),this.l??(this.l=new Headers);for(const[t,e]of Object.entries(this.p))this.l.set(t,e);if(this.A){this.A.headers.forEach(((t,e)=>{this.l?.set(e,t)}));for(const[t,e]of Object.entries(this.p))this.l.set(t,e)}s??(s={});for(const[t,e]of Object.entries(s))if("string"==typeof e)this.l.set(t,e);else{this.l.delete(t);for(const s of e)this.l.append(t,s)}return new Response(t,{status:r,headers:this.l})},this.body=(t,e,s)=>"number"==typeof e?this.O(t,e,s):this.O(t,e),this.text=(t,e,s)=>{if(!this.p){if(!(s||this.A||this.l||e))return new Response(t);this.p={}}return this.p["S"]&&(this.p["S"]="text/plain; charset=UTF-8"),"number"==typeof e?this.O(t,e,s):this.O(t,e)},this.json=(t,e,s)=>{const r=this.h?JSON.stringify(t,null,this.u):JSON.stringify(t);return this.p??(this.p={}),this.p["S"]="application/json; charset=UTF-8","number"==typeof e?this.O(r,e,s):this.O(r,e)},this.T=(t,e,s)=>({response:"number"==typeof e?this.json(t,e,s):this.json(t,e),data:t,format:"json"}),this.C=(t,e,s)=>(this.p??(this.p={}),this.p["S"]="text/html; charset=UTF-8","number"==typeof e?this.O(t,e,s):this.O(t,e)),this.redirect=(t,e=302)=>(this.l??(this.l=new Headers),this.l.set("Location",t),this.O(null,e)),this.cookie=(t,e,s)=>{const r=((t,e,s={})=>{let r=`${t}=${e=encodeURIComponent(e)}`;return s.k&&(r+=`; Max-Age=${Math.floor(s.k)}`),s.domain&&(r+="; Domain="+s.domain),s.path&&(r+="; Path="+s.path),s.expires&&(r+="; Expires="+s.expires.toUTCString()),s.N&&(r+="; HttpOnly"),s.F&&(r+="; Secure"),s.U&&(r+=`; SameSite=${s.U}`),r})(t,e,s);this.v("set-cookie",r,{append:!0})},this.B=()=>this.g(this),this.H=t,e&&(this.D=e.P,this.m=e.path??"/",this.I=e.q,this.t=e.t,e.g&&(this.g=e.g))}get M(){return this.L||(this.L=new class{constructor(t,e="/",s){this.raw=t,this.path=e,this.q=s,this.G={}}W(t){if(this.q){if(t){const e=this.q[t];return e?/\%/.test(e)?c(e):e:void 0}{const t={};for(const[e,s]of Object.entries(this.q))s&&"string"==typeof s&&(t[e]=/\%/.test(s)?c(s):s);return t}}return null}query(t){return a(this.url,t)}Y(t){return((t,e)=>h(t,e,!0))(this.url,t)}v(t){const e={};return this.raw.headers.forEach(((t,s)=>{e[s]=t})),t?e[t.toLowerCase()]:e}cookie(t){const e=this.raw.headers.get("Cookie");if(!e)return;const s=(t=>{const e=t.split(/;\s*/g),s={};for(let t=0,r=e.length;t<r;t++){const r=e[t].split(/\s*=\s*([^\s]+)/);s[r[0]]=c(r[1])}return s})(e);return t?s[t]:s}async J(){return await async function(t){let e={};const s=t.headers.get("Content-Type");if(s&&(s.startsWith("multipart/form-data")||"application/x-www-form-urlencoded"===s)){const s={};(await t.formData()).forEach(((t,e)=>{s[e]=t})),e=s}return e}(this.raw)}json(){return this.raw.json()}text(){return this.raw.text()}arrayBuffer(){return this.raw.arrayBuffer()}blob(){return this.raw.blob()}formData(){return this.raw.formData()}X(t,e){this.G[t]=e}valid(t){if(t)return this.G[t]}get url(){return this.raw.url}get method(){return this.raw.method}get headers(){return this.raw.headers}get redirect(){return this.raw.redirect}get body(){return this.raw.body}get bodyUsed(){return this.raw.bodyUsed}get cache(){return this.raw.cache}get credentials(){return this.raw.credentials}get integrity(){return this.raw.integrity}get keepalive(){return this.raw.keepalive}get mode(){return this.raw.mode}get referrer(){return this.raw.referrer}get V(){return this.raw.referrerPolicy}get signal(){return this.raw.signal}}(this.H,this.m,this.I),this.H=void 0,this.I=void 0),this.L}get event(){if(this.D instanceof FetchEvent)return this.D;throw Error("This context has no FetchEvent")}get P(){if(this.D)return this.D;throw Error("This context has no ExecutionContext")}get $(){return this.A||(this.A=new Response("404 Not Found",{status:404}))}set $(t){this.A&&t&&(this.A.headers.delete("content-type"),this.A.headers.forEach(((e,s)=>{t.headers.set(s,e)}))),this.A=t,this.i=!0}get runtime(){const t=globalThis;return void 0!==t?.Z?"deno":void 0!==t?._?"bun":"function"==typeof t?.K?"workerd":"string"==typeof t?.tt?"edge-light":void 0!==t?.et?"fastly":void 0!==t?.st?"lagon":"node"===t?.process?.release?.name?"node":"other"}},f=(t,e,s)=>{const r=t.length;return(i,n)=>{let o=-1;return function h(a){if(a<=o)throw new Error("next() called multiple times");let c,f=t[a];o=a,a===r&&n&&(f=n);let l=!1;if(f)try{c=f(i,(()=>{const t=h(a+1);return t instanceof Promise?t:Promise.resolve(t)}))}catch(t){if(!(t instanceof Error&&i instanceof u&&e))throw t;i.error=t,c=e(t,i),l=!0}else i instanceof u&&!1===i.i&&s&&(c=s(i));return c instanceof Promise?c.then((t=>(void 0!==t&&"response"in t&&(t=t.response),t&&!1===i.i&&(i.$=t),i))).catch((async t=>{if(t instanceof Error&&i instanceof u&&e)return i.error=t,i.$=await e(t,i),i;throw t})):(void 0!==c&&"response"in c&&(c=c.response),c&&(!1===i.i||l)&&(i.$=c),i)}(0)}},l=class extends Error{constructor(t=500,e){super(e?.message),this.$=e?.$,this.status=t}rt(){return this.$?this.$:new Response(this.message,{status:this.status,statusText:this.message})}},d="ALL",w=["get","post","put","delete","head","options","patch"],p=class extends Error{};var m=t=>t.text("404 Not Found",404),y=(t,e)=>{if(t instanceof l)return t.rt();console.trace(t);return e.text("Internal Server Error",500)},g=class extends class{}{constructor(t={}){super(),this.it="",this.path="*",this.nt=[],this.g=m,this.ot=y,this.ht=t=>this.ct(t.request,t),this.fetch=(t,e,s)=>this.ct(t,s,e),this.request=async(t,e)=>{if(t instanceof Request)return void 0!==e&&(t=new Request(t,e)),await this.fetch(t);t=t.toString();const s=/^https?:\/\//.test(t)?t:`http://localhost${i("/",t)}`,r=new Request(s,e);return await this.fetch(r)},this.ut=()=>{addEventListener("fetch",(t=>{t.ft(this.ht(t))}))};[...w,"all"].map((t=>{this[t]=(e,...s)=>("string"==typeof e?this.path=e:this.lt(t,this.path,e),s.map((e=>{"string"!=typeof e&&this.lt(t,this.path,e)})),this)})),this.dt=(t,e,...s)=>{if(!t)return this;this.path=e;for(const e of[t].flat())s.map((t=>{this.lt(e.toUpperCase(),this.path,t)}));return this},this.wt=(t,...e)=>("string"==typeof t?this.path=t:e.unshift(t),e.map((t=>{this.lt(d,this.path,t)})),this);const e=t.yt??!0;delete t.yt,Object.assign(this,t),this.gt||(this.gt=e?s:r)}clone(){const t=new g({bt:this.bt,gt:this.gt});return t.nt=this.nt,t}vt(t,e){const s=this.$t(t);return e?(e.nt.map((t=>{const r=e.ot===y?t.Et:async(s,r)=>(await f([t.Et],e.ot)(s,r)).$;s.lt(t.method,t.path,r)})),this):s}$t(t){const e=this.clone();return e.it=i(this.it,t),e}Rt(t){return this.ot=t,this}B(t){return this.g=t,this}xt(){this.nt.map((t=>{console.log(`[32m${t.method}[0m ${" ".repeat(8-t.method.length)} ${t.path}`)}))}mount(t,e,s){const r=i(this.it,t),n="/"===r?0:r.length;return this.lt(d,i(t,"*"),(async(t,r)=>{let i;try{i=t.P}catch{}const o=s?s(t):[t.t,i],h=Array.isArray(o)?o:[o],a=await e(new Request(new URL(t.M.path.slice(n)||"/",t.M.url),t.M.raw),...h);if(a)return a;await r()})),this}get jt(){return this.Ot("GET","/"),this.bt.name}lt(t,e,s){t=t.toUpperCase(),this.it&&(e=i(this.it,e)),this.bt.add(t,e,s);const r={path:e,method:t,Et:s};this.nt.push(r)}Ot(t,e){return this.bt.match(t,e)}At(t,e){if(t instanceof Error)return this.ot(t,e);throw t}ct(t,e,s){const r=this.gt(t),i=t.method,n=this.Ot(i,r),o=n?.St,h=new u(t,{t:s,P:e,g:this.g,path:r,q:o});if(1===n?.Tt.length){const t=n.Tt[0];let e;try{if(e=t(h,(async()=>{})),!e)return this.g(h)}catch(t){return this.At(t,h)}return e instanceof Response?e:("response"in e&&(e=e.response),e instanceof Response?e:(async()=>{let t;try{if(t=await e,void 0!==t&&"response"in t&&(t=t.response),!t)return this.g(h)}catch(t){return this.At(t,h)}return t})())}const a=n?n.Tt:[this.g],c=f(a,this.ot,this.g);return(async()=>{try{const t=c(h),e=t instanceof Promise?await t:t;if(!e.i)throw new Error("Context is not finalized. You may forget returning Response object or `await next()`");return e.$}catch(t){return this.At(t,h)}})()}},b="[^/]+",v=".*",$="(?:|/.*)",E=Symbol();function R(t,e){return 1===t.length?1===e.length?t<e?-1:1:-1:1===e.length||t===v||t===$?1:e===v||e===$?-1:t===b?1:e===b?-1:t.length===e.length?t<e?-1:1:e.length-t.length}var x=class{constructor(){this.children={}}Ct(t,e,s,r,i){if(0===t.length){if(void 0!==this.index)throw E;if(i)return;return void(this.index=e)}const[n,...o]=t,h="*"===n?0===o.length?["","",v]:["","",b]:"/*"===n?["","",$]:n.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);let a;if(h){const t=h[1],e=h[2]||b;if(a=this.children[e],!a){if(Object.keys(this.children).some((t=>t!==v&&t!==$)))throw E;if(i)return;a=this.children[e]=new x,""!==t&&(a.kt=r.kt++)}if(!i&&""!==t){if(s.some((e=>e[0]===t)))throw new Error("Duplicate param name");s.push([t,a.kt])}}else if(a=this.children[n],!a){if(Object.keys(this.children).some((t=>t.length>1&&t!==v&&t!==$)))throw E;if(i)return;a=this.children[n]=new x}a.Ct(o,e,s,r,i)}Nt(){const t=Object.keys(this.children).sort(R).map((t=>{const e=this.children[t];return("number"==typeof e.kt?`(${t})@${e.kt}`:t)+e.Nt()}));return"number"==typeof this.index&&t.unshift(`#${this.index}`),0===t.length?"":1===t.length?t[0]:"(?:"+t.join("|")+")"}},j=[d,...w].map((t=>t.toUpperCase())),O={},A=[/^$/,[],{}],S={};function T(t){return S[t]??(S[t]=new RegExp("*"===t?"":`^${t.replace(/\/\*/,"(?:|/.*)")}$`))}function C(t){const e=new class{constructor(){this.context={kt:0},this.root=new x}Ct(t,e,s){const r=[],i=[];for(let e=0;;){let s=!1;if(t=t.replace(/\{[^}]+\}/g,(t=>{const r=`@\\${e}`;return i[e]=[r,t],e++,s=!0,r})),!s)break}const n=t.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let t=i.length-1;t>=0;t--){const[e]=i[t];for(let s=n.length-1;s>=0;s--)if(-1!==n[s].indexOf(e)){n[s]=n[s].replace(e,i[t][1]);break}}return this.root.Ct(n,e,r,this.context,s),r}Ft(){let t=this.root.Nt();if(""===t)return[/^$/,[],[]];let e=0;const s=[],r=[];return t=t.replace(/#(\d+)|@(\d+)|\.\*\$/g,((t,i,n)=>void 0!==i?(s[++e]=Number(i),"$()"):void 0!==n?(r[Number(n)]=++e,""):"")),[new RegExp(`^${t}`),s,r]}},s=[];if(0===t.length)return A;const r={};for(let i=0,n=-1,o=(t=t.sort((([t],[e])=>t.length-e.length))).length;i<o;i++){const o=t[i][0];let h,a=!1;/\*|\/:/.test(o)?n++:(a=!0,r[t[i][0]]={Tt:t[i][1],St:O});try{h=e.Ct(o,n,a)}catch(t){throw t===E?new p(o):t}a||(s[n]=0===h.length?[{Tt:t[i][1],St:O},null]:[t[i][1],h])}const[i,n,o]=e.Ft();for(let t=0,e=s.length;t<e;t++){const e=s[t][1];if(e)for(let t=0,s=e.length;t<s;t++)e[t][1]=o[e[t][1]]}const h=[];for(const t in n)h[t]=s[n[t]];return[i,h,r]}function k(t,e){if(t)for(const s of Object.keys(t).sort(((t,e)=>e.length-t.length)))if(T(s).test(e))return[...t[s]]}var N=class{constructor(){this.name="RegExpRouter",this.Ut={[d]:{}},this.nt={[d]:{}}}add(t,e,s){var r;const{Ut:i,nt:o}=this;if(!i||!o)throw new Error("Can not add a route since the matcher is already built.");if(j.includes(t)||j.push(t),i[t]||[i,o].forEach((e=>{e[t]={},Object.keys(e[d]).forEach((s=>{e[t][s]=[...e[d][s]]}))})),"/*"===e&&(e="*"),/\*$/.test(e)){const n=T(e);return t===d?Object.keys(i).forEach((t=>{var s;(s=i[t])[e]||(s[e]=k(i[t],e)||k(i[d],e)||[])})):(r=i[t])[e]||(r[e]=k(i[t],e)||k(i[d],e)||[]),Object.keys(i).forEach((e=>{t!==d&&t!==e||Object.keys(i[e]).forEach((t=>{n.test(t)&&i[e][t].push(s)}))})),void Object.keys(o).forEach((e=>{t!==d&&t!==e||Object.keys(o[e]).forEach((t=>n.test(t)&&o[e][t].push(s)))}))}const h=n(e)||[e];for(let e=0,r=h.length;e<r;e++){const r=h[e];Object.keys(o).forEach((e=>{var n;t!==d&&t!==e||((n=o[e])[r]||(n[r]=[...k(i[e],r)||k(i[d],r)||[]]),o[e][r].push(s))}))}}match(t,e){S={};const s=this.Bt();return this.match=(t,e)=>{const r=s[t],i=r[2][e];if(i)return i;const n=e.match(r[0]);if(!n)return null;const o=n.indexOf("",1),[h,a]=r[1][o];if(!a)return h;const c={};for(let t=0,e=a.length;t<e;t++)c[a[t][0]]=n[a[t][1]];return{Tt:h,St:c}},this.match(t,e)}Bt(){const t={};return j.forEach((e=>{t[e]=this.Ht(e)||t[d]})),this.Ut=this.nt=void 0,t}Ht(t){const e=[];let s=t===d;return[this.Ut,this.nt].forEach((r=>{const i=r[t]?Object.keys(r[t]).map((e=>[e,r[t][e]])):[];0!==i.length?(s||(s=!0),e.push(...i)):t!==d&&e.push(...Object.keys(r[d]).map((t=>[t,r[d][t]])))})),s?C(e):null}};function F(t,e){for(let s=0,r=t.Dt.length;s<r;s++)if("object"==typeof t.Dt[s]&&t.Dt[s][1]===e)return!0;const s=Object.values(t.children);for(let t=0,r=s.length;t<r;t++)if(F(s[t],e))return!0;return!1}var U=class{constructor(t,e,s){if(this.order=0,this.Pt=!1,this.children=s||{},this.It=[],this.name="",t&&e){const s={};s[t]={Et:e,qt:0,name:this.name},this.It=[s]}this.Dt=[],this.Mt={}}Ct(t,s,r){this.name=`${t} ${s}`,this.order=++this.order;let i=this;const n=(t=>{const e=[];for(let s=0;;){let r=!1;if(t=t.replace(/\{[^}]+\}/g,(t=>{const i=`@\\${s}`;return e[s]=[i,t],s++,r=!0,i})),!r)break}const s=t.split("/");""===s[0]&&s.shift();for(let t=e.length-1;t>=0;t--){const[r]=e[t];for(let i=s.length-1;i>=0;i--)if(-1!==s[i].indexOf(r)){s[i]=s[i].replace(r,e[t][1]);break}}return s})(s),o=[],h=e=>`Duplicate param name, use another name instead of '${e}' - ${t} ${s} <--- '${e}'`;for(let t=0,s=n.length;t<s;t++){const s=n[t];if(Object.keys(i.children).includes(s)){o.push(...i.Dt),i=i.children[s];continue}i.children[s]=new U;const r=e(s);if(r){if("object"==typeof r){this.Pt=!0;for(let t=0,e=o.length;t<e;t++)if("object"==typeof o[t]&&o[t][1]===r[1])throw new Error(h(r[1]));if(Object.values(i.children).some((t=>F(t,r[1]))))throw new Error(h(r[1]))}i.Dt.push(r),o.push(...i.Dt)}o.push(...i.Dt),i=i.children[s],i.Pt=this.Pt}i.It.length||(i.It=[]);const a={},c={Et:r,name:this.name,qt:this.order};return a[t]=c,i.It.push(a),i}Lt(t,e,s){var r,i;return(r=t.Mt)[i=`${e}:${s?"1":"0"}`]||(r[i]=(()=>{const s=[];for(let r=0,i=t.It.length;r<i;r++){const i=t.It[r],n=i[e]||i[d];void 0!==n&&s.push(n)}return s})())}search(t,e){const s=[],r={};let i=[this];const n=(t=>{const e=t.split("/");return""===e[0]&&e.shift(),e})(e);for(let e=0,o=n.length;e<o;e++){const h=n[e],a=e===o-1,c=[];let u=!1;for(let o=0,f=i.length;o<f;o++){const f=i[o],l=f.children[h];l&&(!0===a?(l.children["Gt"]&&s.push(...this.Lt(l.children["Gt"],t,!0)),s.push(...this.Lt(l,t)),u=!0):c.push(l));for(let i=0,o=f.Dt.length;i<o;i++){const o=f.Dt[i];if("*"===o){const e=f.children["Gt"];e&&(s.push(...this.Lt(e,t)),c.push(e));continue}if(""===h)continue;const[l,d,w]=o,p=n.slice(e).join("/");w instanceof RegExp&&w.test(p)?(s.push(...this.Lt(f.children[l],t)),r[d]=p):(!0===w||w instanceof RegExp&&w.test(h))&&("string"==typeof l&&(!0===a?s.push(...this.Lt(f.children[l],t)):c.push(f.children[l])),"string"!=typeof d||u?f.children[h]&&f.children[h].Pt&&(r[d]=h):r[d]=h)}}i=c}const o=s.length;if(0===o)return null;if(1===o)return{Tt:[s[0].Et],St:r};return{Tt:s.sort(((t,e)=>t.qt-e.qt)).map((t=>t.Et)),St:r}}},B=class{constructor(){this.name="TrieRouter",this.node=new U}add(t,e,s){const r=n(e);if(r)for(const e of r)this.node.Ct(t,e,s);else this.node.Ct(t,e,s)}match(t,e){return this.node.search(t,e)}},H=class extends g{constructor(t={}){super(t),this.bt=t.bt??new class{constructor(t){this.name="SmartRouter",this.zt=[],this.nt=[],Object.assign(this,t)}add(t,e,s){if(!this.nt)throw new Error("Can not add a route since the matcher is already built.");this.nt.push([t,e,s])}match(t,e){if(!this.nt)throw new Error("Fatal error");const{zt:s,nt:r}=this,i=s.length;let n,o=0;for(;o<i;o++){const i=s[o];try{r.forEach((t=>{i.add(...t)})),n=i.match(t,e)}catch(t){if(t instanceof p)continue;throw t}this.match=i.match.bind(i),this.zt=[i],this.nt=void 0;break}if(o===i)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.Wt.name}`,n||null}get Wt(){if(this.nt||1!==this.zt.length)throw new Error("No active router has been determined yet.");return this.zt[0]}}({zt:[new N,new B]})}},D=async t=>await P(t,{name:"SHA-256",Yt:"sha256"}),P=async(t,e)=>{let s;if(t instanceof ReadableStream){let s="";const r=t.getReader();return await(r?.read().then((async t=>{const r=await P(t.value||"",e);s+=r}))),s}if(ArrayBuffer.isView(t)||t instanceof ArrayBuffer?s=t:("object"==typeof t&&(t=JSON.stringify(t)),s=(new TextEncoder).encode(String(t))),crypto&&crypto.subtle){const t=await crypto.subtle.digest({name:e.name},s);return Array.prototype.map.call(new Uint8Array(t),(t=>("00"+t.toString(16)).slice(-2))).join("")}return null},I=async(t,e,s)=>{s||(s=D);const r=await s(t),i=await s(e);return!(!r||!i)&&(r===i&&t===e)},q=/^ *(?:[Bb][Aa][Ss][Ii][Cc]) +([A-Za-z0-9._~+/-]+=*) *$/,M=/^([^:]*):(.*)$/,L=new TextDecoder,G=t=>{const e=q.exec(t.headers.get("Authorization")||"");if(!e)return;let s;try{s=M.exec(L.decode((t=>{const e=atob(t),s=new Uint8Array(new ArrayBuffer(e.length)),r=e.length/2;for(let t=0,i=e.length-1;t<=r;t++,i--)s[t]=e.charCodeAt(t),s[i]=e.charCodeAt(i);return s})(e[1])))}catch{}return s?{username:s[1],password:s[2]}:void 0};const z=new H;z.wt("*",(async(t,e)=>{await e(),t.$.headers.set("X-Powered-By","Hono")})),z.wt("/auth/*",((t,...e)=>{if(!t)throw new Error('basic auth middleware requires options for "username and password"');return t.Jt||(t.Jt="Secure Area"),e.unshift({username:t.username,password:t.password}),async(s,r)=>{const i=G(s.M);if(i)for(const s of e){const e=await I(s.username,i.username,t.Xt),n=await I(s.password,i.password,t.Xt);if(e&&n)return void await r()}const n=new Response("Unauthorized",{status:401,headers:{Vt:'Basic realm="'+t.Jt?.replace(/"/g,'\\"')+'"'}});throw new l(401,{$:n})}})({username:"hono",password:"acoolproject"})),z.wt("/etag/*",((t={Zt:!1})=>async(e,s)=>{const r=e.M.v("If-None-Match")||e.M.v("if-none-match");await s();const i=e.$,n=i.clone(),o=await(async t=>await P(t,{name:"SHA-1",Yt:"sha1"}))(i.body||""),h=t.Zt?`W/"${o}"`:`"${o}"`;r&&r===h?(await n.blob(),e.$=new Response(null,{status:304,statusText:"Not Modified",headers:{_t:h}}),e.$.headers.delete("Content-Length")):(e.$=new Response(n.body,n),e.$.headers.set("ETag",h))})()),z.wt("/hello/*",(async(t,e)=>{await e(),t.v("X-message","This is addHeader middleware!")})),z.wt("*",(async(t,e)=>{const s=Date.now();await e();const r=Date.now()-s;t.v("X-Response-Time",`${r}ms`)})),z.B((t=>t.text("Custom 404 Not Found",404))),z.Rt(((t,e)=>(console.error(`${t}`),e.text("Custom Error Message",500)))),z.get("/",(t=>t.text("Hono!!"))),z.get("/hello",(()=>new Response("This is /hello"))),z.get("/entry/:id",(t=>{const e=t.M.W("id");return t.text(`Your ID is ${e}`)}));const W=new H;W.get("/",(t=>t.text("List Books"))),W.get("/:id",(t=>{const e=t.M.W("id");return t.text("Get Book: "+e)})),W.Kt("/",(t=>t.text("Create Book"))),z.vt("/book",W),z.get("/redirect",(t=>t.redirect("/"))),z.get("/auth/*",(t=>t.text("You are authorized"))),z.get("/etag/cached",(t=>t.text("Is this cached?"))),z.get("/fetch-url",(async t=>{const e=await fetch("https://example.com/");return t.text(`https://example.com/ is ${e.status}`)})),z.get("/user-agent",(t=>{const e=t.M.v("User-Agent");return t.text(`Your UserAgent is ${e}`)})),z.get("/api/posts",((t={Qt:2})=>async(e,s)=>{const r=!(!e.M.query("pretty")&&""!==e.M.query("pretty"));e.j(r,t.Qt),await s()})(),(t=>t.json([{id:1,title:"Good Morning"},{id:2,title:"Good Aternoon"},{id:3,title:"Good Evening"},{id:4,title:"Good Night"}]))),z.Kt("/api/posts",(t=>t.json({message:"Created!"},201))),z.get("/api/*",(t=>t.text("API endpoint is not found",404))),z.get("/error",(()=>{throw Error("Error has occurred")})),z.get("/type-error",(()=>"return not Response instance"));export{z as default};
